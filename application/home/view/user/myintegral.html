{extend name="public/common"}

{block name="style"}
<link rel="stylesheet" href="/home/css/user/myintegral.css">
{/block}

{block name="body"}

<div class="main">
    <div class="banner">
        <div class="loadingParent">
            <canvas id="myCanvas" width="400" height="300"></canvas>
            <canvas id="dashed" width="400" height="300"></canvas>
            <p class="point">我的积分</p>
            <p class="num">{$score}</p>
            <p class="time">时间：{$time}</p>
        </div>
        <p class="rule" data-toggle="modal" data-target="#myModal">积分规则</p>
    </div>
    <div class="line">
        <span>积分明细</span>
    </div>
    <ul class="in-points">
        {volist name="$msg" id="ms"}
        <li>
            <p class="title">
                <span>{$ms.str}</span>
            </p>
            <p class="content">
                {$ms.title}
            </p>
            <p class="time">
                {$ms.create_time}
            </p>
            <p class="point">
                <img src="/home/images/user/point.png">
                <span>+ {$ms.score}</span>
            </p>
        </li>
        {/volist}
        {volist name="$handle" id="han"}
        <li>
            <p class="title">
                <span>{$han.str}</span>
            </p>
            <p class="content">
            </p>
            <p class="time">
                {$han.create_time}
            </p>
            <p class="point">
                <img src="/home/images/user/point.png">
                <span>{$han.score}</span>
            </p>
        </li>
        {/volist}
    </ul>


    <!-- 模态框（Modal） -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog"
         aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <img src="/home/images/user/close.png" alt="规则" data-dismiss="modal" aria-hidden="true" style="width:12vw;height:12vw" id="close">
            <div class="modal-content" style="margin:6vw auto" id="modalBody">
                <div style="width: 0;height: 6.4vw;border-right: 2px solid rgba(237, 218, 145, 0.63);margin: -6.4vw auto 0;"></div>
                <div class="modal-header">
                    <h4 class="modal-title" id="myModalLabel">
                        <b>积分规则</b>
                    </h4>
                </div>
                <div class="modal-body">
                    <h4 style="font-weight: normal">
                        <p>1、党建责任</p>
                        <span>【专题研究】 党组（党委）听取工作汇报和专题研究机关党建工作解决实际问题每年两次及以上（2分），每次1分 </span><br>
                        <span>【责任清单】 制定年度机关党建工作要点和党组（党委）书记抓机关党建工作责任清单（2分）：有党建工作要点1分，有书记责任清单1分 </span><br>
                        <span>【述职报告】 书记述职1000字以上1分，支部书记述职800字以上1分 </span><br>
                        <span>【两新党建】 线下考核（2分）
</span><br>
                        <p>2、两学一做</p>
                        <span>【方案部署】 按要求推进“两学一做”学习教育（2分）：有方案1分、有部署会议1分 </span><br>
                        <span>【三会一课】 支部党员大会1分，每季度一次，每次0.25分；支部委员会1分，每月一次，每次0.1分；领导干部讲党课1分，党小组会1分，每月一次，每次0.1分。</span><br>
                        <span>【年度计划】 全年学习计划和培训计划1分，党建理论研究文章1500字1分 </span><br>
                        <span>【支部活动】 上传领导干部参加支部活动情况表2分，每月1次，每次0.2分 </span><br>
                        <p>3、作风建设</p>
                        <span>【方案部署】 “作风建设年”活动有部署、有方案（2分）</span><br>
                        <span>【金点子】 开展“解放思想，担当有为”主题大讨论和“金点子”征集活动 (2分)</span><br>
                        <span>【培树典型】 挖掘培树“大抓项目年”和“作风建设年”活动中涌现出的先进典型（2分）</span><br>
                        <span>【党员清单】 有党员个人问题清单和整改清单 (2分) </span><br>
                        <span>【机关效能】 抓好机关效能建设，严格落实“六个严禁”（2分）线下考核 </span><br>
                        <span>【查处通报】 本部门干部职工因作风建设问题被上级机关查处通报的，扣4分，被市本级查处通报的，每例扣2分，反馈本单位处理的每例扣1分 线下考核 </span><br>
                        <p>4、志愿服务</p>
                        <span>【四跑志愿活动】 开展“比跑、领跑、助跑、联跑”活动有方案、有记录、有总结、有成效（2分）</span><br>
                        <span>【一条街三走进】参与或组织机关党员志愿服务一条街主题活动、机关在职党员进社区、机关党员走进农村、走进社区、走进企业活动、全国文明城市创建全国卫生城市巩固活动并提供台账资料（2分）；加强本部门系统内的市、县、乡三级联动，不定期开展“最多跑一次”改革事项志愿服务活动，并提供台账资料（2分）</span><br>
                        <p>5、组织建设</p>
                        <span>【规范化建设】 抓好阵地建设0.5分，按期换届0.5分，主题党日1分，每月1次，每次0.1分 </span><br>
                        <span>【离退休党员台账资料】 认真做好离退休党员的日常教育管理和服务工作，离退休支部组织健全、生活正常，老同志满意度达到80%以上并提供台账资料（3分）</span><br>
                        <span>【党费收缴】 有党费收缴清单、收缴记录簿、党费证1分 </span><br>
                        <span>【信息录用】 组织本单位党员干部关注“台州红云”订阅号，被《台州机关党建》简报或“台州红云”微平台录用信息4条以上2分，每次0.5分 </span><br>
                        <p>6、党风廉政</p>
                        <span>【廉政责任】 落实机关党风廉政建设主体责任，有方案有记录（2分）</span><br>
                        <span>【廉政教育】 抓好廉政教育和机关廉政文化建设（2分）</span><br>
                        <span>【纪检报告】 落实机关纪检工作情况报告制度1000字2分 </span><br>
                        <span>【四种形态】 践行“四种形态”，正确适用党纪处分和问责条例（2分）线下考核 </span><br>
                        <p>7、特色创新</p>
                        <span>特色工作开展情况报告1200字以上+2分，提供表彰、刊发照片+5分，提供交流凭证+3分 </span><br>
                        <p>8、满意度测评</p>
                        <span>线下考核（40分）</span><br>
                    </h4>

                </div>
                <!--<div class="modal-footer">-->
                <!--<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>-->
                <!--</div>-->
            </div>
        </div>
    </div><!-- /.modal -->

</div>

{/block}

{block name="script"}
<script>
    $(function(){
        function IsPC() {
            var userAgentInfo = navigator.userAgent;
            var Agents = ["Android", "iPhone",
                "SymbianOS", "Windows Phone",
                "iPad", "iPod"];
            var flag = true;
            for (var v = 0; v < Agents.length; v++) {
                if (userAgentInfo.indexOf(Agents[v]) > 0) {
                    flag = false;
                    break;
                }
            }
            return flag;
        }

        flag = IsPC();
        if(flag){
            $(".main").css({"width":"640px","left":"50%","min-height":"90vh","margin":"5vh 0 0 -320px","position":"relative"});
            $(".banner").css({"width":"640px","margin":"0 auto","height":"320px"});
            $("#myCanvas").css({"height":"210px","width":"300px"});
            $("#dashed").css({"height":"250px","width":"320px"});
            $(".banner .point").css({"top":"50px"});
            $(".banner .point").css({"top":"50px","font-size":"20px"});
            $(".banner .num").css({"top":"90px","font-size":"32px"});
            $(".banner .time").css({"top":"140px","font-size":"18px"});
            $(".rule").css({"width":"280px","height":"40px","line-height":"40px","top":"0"});
            $(".line").css({"width":"640px","margin":"0 auto"});
            $(".line span").css("font-size","18px");
            $(".in-points").css({"width":"640px","margin":"0 auto"});
            $("ul li .title span").css("font-size","18px");
            $("ul li .content").css("font-size","16px");
            $("ul li .time").css("font-size","14px");
            $("ul li .point").css({"right":"50%","margin-right":"-320px"});
            $(".modal-content").css({"width":"600px","height":"540px"});
            $(".modal-dialog").css("margin-top","80px");
            $("#close").css({"margin":"0 auto 0 auto","width":"80px","height":"80px"});
            $(".modal-open").css({"postion":"static","overflow":"hidden"})
        }else{
            $(".modal-open").css({"postion":"fixed","overflow":"hidden"})
        }
    });

    window.onload = function(){
        if(flag){
            $(".modal-open").css({"postion":"static","overflow":"hidden"})
        }
    }

    var width = $(window).width();
    $("#myCanvas").css("width",width);
    $("#dashed").css("width",width);

    //外圆
    var canvas = document.getElementById("myCanvas");
    var context = canvas.getContext("2d");
    context.lineWidth = 2;
    context.strokeStyle = "#fff";
    var centerX =200;
    var centerY = 180;
    var radius = 150;
    var startingAngle = 0.9 * Math.PI;
    var endingAngle = 2.1 * Math.PI;
    context.arc(centerX, centerY, radius, startingAngle, endingAngle);
    context.stroke();


    //虚线圆
    var dashed = document.getElementById("dashed");
    var ctx = dashed.getContext("2d");
    ctx.strokeStyle = "#fff";
    ctx.setLineDash([5, 10]);
    ctx.arc(centerX, centerY, 130, startingAngle, endingAngle);
    ctx.stroke();

    mui('#refreshContainer').on('tap', '.rule', function(e) {
        $('#myModal').show();
        $("html").addClass("modal-open");
    });

    $(".modal").click(function(){
        $("html").removeClass("modal-open");
    })
    $(".modal-content").on("click",function(e){
        e.stopPropagation();
    })

</script>
{/block}
